<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  
  <title>Mastering Python Design Patterns | Pegasus&#39; Blog</title>
  <meta name="author" content="PegasusWang">
  
  <meta name="description" content="PegasusWang çš„æ—¥å¸¸è®°å½•">
  
  
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  <meta property="og:title" content="Mastering Python Design Patterns"/>
  <meta property="og:site_name" content="Pegasus&#39; Blog"/>

  
    <meta property="og:image" content=""/>
  

  <link href="/favicon.ico" rel="icon">
  <link rel="alternate" href="/atom.xml" title="Pegasus&#39; Blog" type="application/atom+xml">
  <link rel="stylesheet" href="//netdna.bootstrapcdn.com/bootstrap/3.1.0/css/bootstrap.min.css">
<link rel="stylesheet" href="//netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css">
<link rel="stylesheet" href="/css/style.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
  <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
  
</head>

<body>
  <header id="header" class='normal_mode'>
    <nav id="main-nav">
  <ul class='container'>
    
      <li><a href="/archives">Archives</a></li>
    
      <li><a href="/about">About</a></li>
    
      <li><a href="https://github.com/pegasuswang/vim-config">Neovim</a></li>
    
      <li><a href="https://www.zhihu.com/people/pegasus-wang/activities">çŸ¥ä¹</a></li>
    
      <li><a href="http://python-web-guide.readthedocs.io/zh/latest/">Pythonå…¥å‘æŒ‡å—</a></li>
    
  </ul>
  <div class="clearfix"></div>
</nav>
  </header>
  <div id="content" class="container">
    <article class="post">
  
    <div class="gallery">
  <div class="photoset">
    
      <img src="">
    
  </div>
  <div class="control">
    <div class="prev"></div>
    <div class="next"></div>
  </div>
</div>
  
  <div class="post-content">
    <header>
      
      <time datetime="2017-01-02T16:08:27.000Z"><a href="/2017/01/03/python/master-python-design-patterns/">å‘¨äºŒ, 1æœˆ 3 2017, 12:08:27 å‡Œæ™¨</a></time>

  
    <h1 class="title">Mastering Python Design Patterns</h1>
  


  
  <div class="categories">
  	<i class="fa fa-folder-open"></i>
    <a href="/categories/python/">python</a>
  </div>


  
  <div class="tags">
  	<i class="fa fa-tag"></i>
    <a href="/tags/python/">python</a>, <a href="/tags/design-pattern/">design-pattern</a>
  </div>

<div class="clear"></div>
      
    </header>
    <div class="entry">
      
        <blockquote>
<p>Patterns mean â€œI have run out of language.â€ - Rich Hickey</p>
</blockquote>
<p>ä¹‹å‰å­¦ä¹ è®¾è®¡æ¨¡å¼çš„æ—¶å€™æ€»æ˜¯æ²¡æœ‰ä»€ä¹ˆæ„Ÿè§‰ï¼Œå› ä¸ºè®°æ€§ä¸å¥½ä¸€ç›´æ²¡è®°ä½å¤šå°‘ã€‚pythonä¸åƒjavaä¸­æ¯”è¾ƒå¼ºè°ƒè®¾è®¡æ¨¡å¼(ç¼–ç¨‹å¥—è·¯)ï¼ŒåŠ¨æ€è¯­è¨€ä¹Ÿå†…ç½®äº†åƒæ˜¯è£…é¥°å™¨ã€è¿­ä»£å™¨ç­‰æ¨¡å¼ï¼Œå¦å¤–pythonä¸­çš„ã€ä¸€åˆ‡çš†å¯¹è±¡ã€ã€é¸­å­ç±»å‹ç­‰ä¹Ÿå¯¼è‡´pythonä¸­å®ç°çš„è®¾è®¡æ¨¡å¼å’Œå…¶ä»–è¯­è¨€æœ‰äº›å·®åˆ«ã€‚æ ¹æ®YAGNI(you arenâ€™t gonna need it)å’ŒKISS(Keep it simple sutpid)åŸåˆ™ï¼Œå¦‚æœèƒ½ç”¨ç®€å•æ˜“æ‡‚çš„æ–¹å¼å®ç°ï¼Œæœ€å¥½ä¸è¦æ»¥ç”¨è®¾è®¡æ¨¡å¼ä»¥å…å¢åŠ å¤æ‚åº¦å’Œç»´æŠ¤éš¾åº¦ã€‚æœ¬åšå®¢æ˜¯ã€ŠMastering Python Design Patternsã€‹çš„è¯»ä¹¦ç¬”è®°ï¼Œæ¶µç›–å¤§éƒ¨åˆ†è®¾è®¡æ¨¡å¼(åŠ›æ±‚pythonicå®ç°)ï¼Œæœ‰å…´è¶£å¯ä»¥å‚è€ƒä¸‹ï¼Œä»£ç ç¤ºä¾‹ç‰ˆæœ¬ä¸ºpython3.5.2ã€‚ï¼ˆ3.6éƒ½å‘å¸ƒäº†ï¼Œå·²ç»è¢«æ—¶ä»£é—å¼ƒğŸ˜¢â€¦â€¦)</p>
<a id="more"></a>
<hr>
<h2 id="1-The-Fctory-Pattern-å·¥å‚æ¨¡å¼-è§£å†³å¯¹è±¡åˆ›å»ºé—®é¢˜"><a href="#1-The-Fctory-Pattern-å·¥å‚æ¨¡å¼-è§£å†³å¯¹è±¡åˆ›å»ºé—®é¢˜" class="headerlink" title="1: The Fctory Pattern(å·¥å‚æ¨¡å¼: è§£å†³å¯¹è±¡åˆ›å»ºé—®é¢˜)"></a>1: The Fctory Pattern(å·¥å‚æ¨¡å¼: è§£å†³å¯¹è±¡åˆ›å»ºé—®é¢˜)</h2><p>å…ˆæ¥çœ‹ä¸‰ç§åˆ›å»ºæ¨¡å¼ä¸­çš„ç¬¬ä¸€ç§å·¥å‚æ¨¡å¼ã€‚<br>è§£é‡Šï¼šå¤„ç†å¯¹è±¡åˆ›å»ºï¼Œå®¢æˆ·ç«¯å¯ä»¥ç”³è¯·ä¸€ä¸ªå¯¹è±¡è€Œä¸ç”¨çŸ¥é“å¯¹è±¡è¢«å“ªä¸ªclassåˆ›å»ºã€‚å¯ä»¥æ–¹ä¾¿åœ°è§£è€¦å¯¹è±¡çš„ä½¿ç”¨å’Œåˆ›å»ºã€‚æœ‰ä¸¤ç§å®ç°ï¼Œå·¥å‚æ–¹æ³•å’ŒæŠ½è±¡å·¥å‚.</p>
<h3 id="Factory-Method-å·¥å‚æ–¹æ³•-ï¼šæ‰§è¡Œå•ç‹¬çš„å‡½æ•°ï¼Œé€šè¿‡ä¼ å‚æä¾›éœ€è¦çš„å¯¹è±¡çš„ä¿¡æ¯ã€‚é€šè¿‡ä¸€ä¸ªdemoçœ‹çœ‹ä¾‹å­"><a href="#Factory-Method-å·¥å‚æ–¹æ³•-ï¼šæ‰§è¡Œå•ç‹¬çš„å‡½æ•°ï¼Œé€šè¿‡ä¼ å‚æä¾›éœ€è¦çš„å¯¹è±¡çš„ä¿¡æ¯ã€‚é€šè¿‡ä¸€ä¸ªdemoçœ‹çœ‹ä¾‹å­" class="headerlink" title="Factory Method(å·¥å‚æ–¹æ³•)ï¼šæ‰§è¡Œå•ç‹¬çš„å‡½æ•°ï¼Œé€šè¿‡ä¼ å‚æä¾›éœ€è¦çš„å¯¹è±¡çš„ä¿¡æ¯ã€‚é€šè¿‡ä¸€ä¸ªdemoçœ‹çœ‹ä¾‹å­:"></a>Factory Method(å·¥å‚æ–¹æ³•)ï¼šæ‰§è¡Œå•ç‹¬çš„å‡½æ•°ï¼Œé€šè¿‡ä¼ å‚æä¾›éœ€è¦çš„å¯¹è±¡çš„ä¿¡æ¯ã€‚é€šè¿‡ä¸€ä¸ªdemoçœ‹çœ‹ä¾‹å­:</h3><pre><code>import json
import xml.etree.ElementTree as etree

class JSONConnector:
    def __init__(self, filepath):
        self.data = dict()
        with open(filepath, mode=&apos;r&apos;, encoding=&apos;utf8&apos;) as f:
            self.data = json.load(f)

    @property
    def parsed_data(self):
        return self.data


class XMLConnector:
    def __init__(self, filepath):
        self.tree = etree.parse(filepath)

    @property
    def parsed_data(self):
        return self.tree


def connection_factory(filepath):
    &quot;&quot;&quot; å·¥å‚æ–¹æ³• &quot;&quot;&quot;
    if filepath.endswith(&apos;json&apos;):
        connector = JSONConnector
    elif filepath.endswith(&apos;xml&apos;):
        connector = XMLConnector
    else:
        raise ValueError(&apos;Cannot connect to {}&apos;.format(filepath))
    return connector(filepath)
</code></pre><h3 id="Abstract-Factory-æŠ½è±¡å·¥å‚-è§£å†³å¤æ‚å¯¹è±¡åˆ›å»ºé—®é¢˜"><a href="#Abstract-Factory-æŠ½è±¡å·¥å‚-è§£å†³å¤æ‚å¯¹è±¡åˆ›å»ºé—®é¢˜" class="headerlink" title="Abstract Factory(æŠ½è±¡å·¥å‚: è§£å†³å¤æ‚å¯¹è±¡åˆ›å»ºé—®é¢˜)"></a>Abstract Factory(æŠ½è±¡å·¥å‚: è§£å†³å¤æ‚å¯¹è±¡åˆ›å»ºé—®é¢˜)</h3><p>å·¥å‚æ–¹æ³•é€‚åˆå¯¹è±¡ç§ç±»è¾ƒå°‘çš„æƒ…å†µï¼Œå¦‚æœæœ‰å¤šç§ä¸åŒç±»å‹å¯¹è±¡éœ€è¦åˆ›å»ºï¼Œä½¿ç”¨æŠ½è±¡å·¥å‚æ¨¡å¼ã€‚ä»¥å®ç°ä¸€ä¸ªæ¸¸æˆçš„ä¾‹å­è¯´æ˜ï¼Œåœ¨ä¸€ä¸ªæŠ½è±¡å·¥å‚ç±»é‡Œå®ç°å¤šä¸ªå…³è”å¯¹è±¡çš„åˆ›å»ºï¼š</p>
<pre><code>class Frog:
    def __init__(self, name):
        self.name = name

    def __str__(self):
        return self.name

    def interact_with(self, obstacle):
        &quot;&quot;&quot; ä¸åŒç±»å‹ç©å®¶é‡åˆ°çš„éšœç¢ä¸åŒ &quot;&quot;&quot;
        print(&apos;{} the Frog encounters {} and {}!&apos;.format(
            self, obstacle, obstacle.action()))


class Bug:
    def __str__(self):
        return &apos;a bug&apos;

    def action(self):
        return &apos;eats it&apos;


class FrogWorld:
    def __init__(self, name):
        print(self)
        self.player_name = name

    def __str__(self):
        return &apos;\n\n\t----Frog World -----&apos;

    def make_character(self):
        return Frog(self.player_name)

    def make_obstacle(self):
        return Bug()


class Wizard:
    def __init__(self, name):
        self.name = name

    def __str__(self):
        return self.name

    def interact_with(self, obstacle):
        print(&apos;{} the Wizard battles against {} and {}!&apos;.format(
            self, obstacle, obstacle.action()))


class Ork:
    def __str__(self):
        return &apos;an evil ork&apos;

    def action(self):
        return &apos;kill it&apos;


class WizardWorld:
    def __init__(self, name):
        print(self)
        self.player_name = name

    def __str__(self):
        return &apos;\n\n\t------ Wizard World -------&apos;

    def make_character(self):
        return Wizard(self.player_name)

    def make_obstacle(self):
        return Ork()


class GameEnvironment:
    &quot;&quot;&quot; æŠ½è±¡å·¥å‚ï¼Œæ ¹æ®ä¸åŒçš„ç©å®¶ç±»å‹åˆ›å»ºä¸åŒçš„è§’è‰²å’Œéšœç¢ (æ¸¸æˆç¯å¢ƒ)
    è¿™é‡Œå¯ä»¥æ ¹æ®å¹´é¾„åˆ¤æ–­ï¼Œæˆå¹´äººè¿”å›ã€å·«å¸ˆã€æ¸¸æˆï¼Œå°å­©è¿”å›ã€é’è›™è¿‡æ²³ã€æ¸¸æˆ&quot;&quot;&quot;
    def __init__(self, factory):
        self.hero = factory.make_character()
        self.obstacle = factory.make_obstacle()

    def play(self):
        self.hero.interact_with(self.obstacle)
</code></pre><hr>
<h2 id="2-The-Builder-Pattern-æ„é€ æ¨¡å¼-æ§åˆ¶å¤æ‚å¯¹è±¡çš„æ„é€ "><a href="#2-The-Builder-Pattern-æ„é€ æ¨¡å¼-æ§åˆ¶å¤æ‚å¯¹è±¡çš„æ„é€ " class="headerlink" title="2: The Builder Pattern(æ„é€ æ¨¡å¼: æ§åˆ¶å¤æ‚å¯¹è±¡çš„æ„é€ )"></a>2: The Builder Pattern(æ„é€ æ¨¡å¼: æ§åˆ¶å¤æ‚å¯¹è±¡çš„æ„é€ )</h2><p>å½“å¯¹è±¡éœ€è¦å¤šä¸ªéƒ¨åˆ†ç»„åˆèµ·æ¥ä¸€æ­¥æ­¥åˆ›å»ºï¼Œå¹¶ä¸”åˆ›å»ºå’Œè¡¨ç¤ºåˆ†ç¦»çš„æ—¶å€™ã€‚å¯ä»¥è¿™ä¹ˆç†è§£ï¼Œä½ è¦ä¹°ç”µè„‘ï¼Œå·¥å‚æ¨¡å¼ç›´æ¥è¿”å›ä¸€ä¸ªä½ éœ€è¦å‹å·çš„ç”µè„‘ï¼Œä½†æ˜¯æ„é€ æ¨¡å¼å…è®¸ä½ è‡ªå®šä¹‰ç”µè„‘å„ç§é…ç½®ç±»å‹ï¼Œç»„è£…å®Œæˆåç»™ä½ ã€‚è¿™ä¸ªè¿‡ç¨‹ä½ å¯ä»¥ä¼ å…¥builderä»è€Œè‡ªå®šä¹‰åˆ›å»ºçš„æ–¹å¼ã€‚</p>
<pre><code># factory pattern
MINI14 = &apos;1.4GHz Mac mini&apos;


class AppleFactory:

    class MacMini14:
        def __init__(self):
            self.memory = 4  # in gigabytes
            self.hdd = 500  # in gigabytes
            self.gpu = &apos;Intel HD Graphics 5000&apos;

        def __str__(self):
            info = (&apos;Model: {}&apos;.format(MINI14),
                    &apos;Memory: {}GB&apos;.format(self.memory),
                    &apos;Hard Disk: {}GB&apos;.format(self.hdd),
                    &apos;Graphics Card: {}&apos;.format(self.gpu))
            return &apos;\n&apos;.join(info)

    def build_computer(self, model):
        if model == MINI14:
            return self.MacMini14()
        else:
            print(&quot;I don&apos;t know how to build {}&quot;.format(model))


# ä½¿ç”¨å·¥å‚
afac = AppleFactory()
mac_mini = afac.build_computer(MINI14)
print(mac_mini)


# builderæ¨¡å¼


class Computer:
    def __init__(self, serial_number):
        self.serial = serial_number
        self.memory = None      # in gigabytes
        self.hdd = None         # in gigabytes
        self.gpu = None

    def __str__(self):
        info = (&apos;Memory: {}GB&apos;.format(self.memory),
                &apos;Hard Disk: {}GB&apos;.format(self.hdd),
                &apos;Graphics Card: {}&apos;.format(self.gpu))
        return &apos;\n&apos;.join(info)


class ComputerBuilder:
    def __init__(self):
        self.computer = Computer(&apos;AG23385193&apos;)

    def configure_memory(self, amount):
        self.computer.memory = amount

    def configure_hdd(self, amount):
        self.computer.hdd = amount

    def configure_gpu(self, gpu_model):
        self.computer.gpu = gpu_model


class HardwareEngineer:
    def __init__(self):
        self.builder = None

    def construct_computer(self, memory, hdd, gpu):
        self.builder = ComputerBuilder()
        [step for step in (self.builder.configure_memory(memory),
                        self.builder.configure_hdd(hdd),
                        self.builder.configure_gpu(gpu))]

    @property
    def computer(self):
        return self.builder.computer

# ä½¿ç”¨buidlerï¼Œå¯ä»¥åˆ›å»ºå¤šä¸ªbuilderç±»å®ç°ä¸åŒçš„ç»„è£…æ–¹å¼
engineer = HardwareEngineer()
engineer.construct_computer(hdd=500, memory=8, gpu=&apos;GeForce GTX 650 Ti&apos;)
computer = engineer.computer
print(computer)
</code></pre><hr>
<h2 id="3-The-Prototype-Pattern-åŸå‹æ¨¡å¼-è§£å†³å¯¹è±¡æ‹·è´é—®é¢˜"><a href="#3-The-Prototype-Pattern-åŸå‹æ¨¡å¼-è§£å†³å¯¹è±¡æ‹·è´é—®é¢˜" class="headerlink" title="3:The Prototype Pattern(åŸå‹æ¨¡å¼:è§£å†³å¯¹è±¡æ‹·è´é—®é¢˜)"></a>3:The Prototype Pattern(åŸå‹æ¨¡å¼:è§£å†³å¯¹è±¡æ‹·è´é—®é¢˜)</h2><p>è¿™æ˜¯åˆ›å»ºæ¨¡å¼ä¸­çš„æœ€åä¸€ä¸ªï¼Œç”¨æ¥å…‹éš†ä¸€ä¸ªå¯¹è±¡ï¼Œæœ‰ç‚¹åƒç”Ÿç‰©å­¦ä¸­çš„æœ‰ä¸åˆ†è£‚ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨pythonå†…ç½®çš„copyæ¨¡å—å®ç°ã€‚æ‹·è´åˆ†ä¸ºæ·±æ‹·è´å’Œæµ…æ‹·è´ï¼Œæ·±æ‹·è´ä¼šé€’å½’å¤åˆ¶å¹¶åˆ›å»ºæ–°å¯¹è±¡ï¼Œè€Œæµ…æ‹·è´ä¼šåˆ©ç”¨å¼•ç”¨æŒ‡å‘åŒä¸€ä¸ªå¯¹è±¡.æ·±æ‹·è´çš„ä¼˜ç‚¹æ˜¯å¯¹è±¡ä¹‹é—´äº’ä¸å½±å“ï¼Œä½†æ˜¯ä¼šè€—è´¹èµ„æºï¼Œåˆ›å»ºæ¯”è¾ƒè€—æ—¶ï¼›å¦‚æœä¸ä¼šä¿®æ”¹å¯¹è±¡å¯ä»¥ä½¿ç”¨æµ…æ‹·è´ï¼Œæ›´åŠ èŠ‚çœèµ„æºå’Œåˆ›å»ºæ—¶é—´ã€‚</p>
<ul>
<li>â€œA shallow copy constructs a new compound object and then (to the extent possible) inserts references into it to the objects found in the original.</li>
<li>A deep copy constructs a new compound object and then, recursively, inserts copies into it of the objects found in the original.â€</li>
</ul>
<pre><code>import copy
from collections import OrderedDict

class Book:
    def __init__(self, name, authors, price, **rest):
        &apos;&apos;&apos;Examples of rest: publisher, length, tags, publication
        date&apos;&apos;&apos;
        self.name = name
        self.authors = authors
        self.price = price      # in US dollars
        self.__dict__.update(rest)

    def __str__(self):
        mylist = []
        ordered = OrderedDict(sorted(self.__dict__.items()))
        for i in ordered.keys():
            mylist.append(&apos;{}: {}&apos;.format(i, ordered[i]))
            if i == &apos;price&apos;:
                mylist.append(&apos;$&apos;)
            mylist.append(&apos;\n&apos;)
        return &apos;&apos;.join(mylist)


class Prototype:
    def __init__(self):
        self.objects = {}

    def register(self, identifier, obj):
        self.objects[identifier] = obj

    def unregister(self, identifier):
        del self.objects[identifier]

    def clone(self, identifier, **attr):
        &quot;&quot;&quot; å®ç°å¯¹è±¡æ‹·è´ &quot;&quot;&quot;
        found = self.objects.get(identifier)
        if not found:
            raise ValueError(&apos;Incorrect object identifier: {}&apos;.format(identifier))
        obj = copy.deepcopy(found)
        obj.__dict__.update(attr)    # å®ç°æ‹·è´æ—¶è‡ªå®šä¹‰æ›´æ–°
        return obj


def main():
    b1 = Book(&apos;The C Programming Language&apos;, (&apos;Brian W. Kernighan&apos;, &apos;Dennis M.Ritchie&apos;),
            price=118, publisher=&apos;Prentice Hall&apos;, length=228, publication_date=&apos;1978-02-22&apos;,
            tags=(&apos;C&apos;, &apos;programming&apos;, &apos;algorithms&apos;, &apos;data structures&apos;))

    prototype = Prototype()
    cid = &apos;k&amp;r-first&apos;
    prototype.register(cid, b1)
    b2 = prototype.clone(cid, name=&apos;The C Programming Language (ANSI)&apos;, price=48.99, length=274,
                        publication_date=&apos;1988-04-01&apos;, edition=2)
    for i in (b1, b2):
        print(i)
        print(&quot;ID b1 : {} != ID b2 : {}&quot;.format(id(b1), id(b2)))
</code></pre><hr>
<h2 id="4-The-Adapter-Pattern-é€‚é…å™¨æ¨¡å¼-è§£å†³æ¥å£ä¸å…¼å®¹é—®é¢˜"><a href="#4-The-Adapter-Pattern-é€‚é…å™¨æ¨¡å¼-è§£å†³æ¥å£ä¸å…¼å®¹é—®é¢˜" class="headerlink" title="4: The Adapter Pattern(é€‚é…å™¨æ¨¡å¼: è§£å†³æ¥å£ä¸å…¼å®¹é—®é¢˜)"></a>4: The Adapter Pattern(é€‚é…å™¨æ¨¡å¼: è§£å†³æ¥å£ä¸å…¼å®¹é—®é¢˜)</h2><p>å¼€å§‹ä»‹ç»ç»“æ„å‹è®¾è®¡æ¨¡å¼ï¼Œç»“æ„å‹è®¾è®¡æ¨¡å¼é€šè¿‡ç»„åˆå¯¹è±¡æ¥å®ç°æ–°åŠŸèƒ½ã€‚é€‚é…å™¨æ¨¡å¼é€šè¿‡å¼•å…¥é—´æ¥å±‚æ¥å®ç°ä¸å…¼å®¹æ¥å£ä¹‹é—´çš„é€‚é…ã€‚ç°å®ä¸­æœ€å¥½çš„ä¾‹å­å°±æ˜¯æ‰‹æœºå……ç”µå£ï¼Œä¸åŒå‹å·å®‰å“æ‰‹æœºéƒ½å¯ä»¥ç”¨åŒæ ·çš„å……ç”µçº¿å……ç”µã€‚åœ¨pythonä¸­å¯ä»¥é€šè¿‡ç»§æ‰¿å®ç°é€‚é…ï¼Œä¹Ÿå¯ä»¥é€šè¿‡ä½¿ç”¨classçš„<strong>dict</strong>å±æ€§ã€‚<br>å¼€é—­åŸåˆ™ï¼šé€‚é…å™¨æ¨¡å¼å’ŒOOPä¸­çš„å¼€é—­åŸåˆ™å…³ç³»å¯†åˆ‡ï¼Œå¼€é—­åŸåˆ™å¼ºè°ƒå¯¹æ‰©å±•å¼€æ”¾ï¼Œå¯¹ä¿®æ”¹å…³é—­ã€‚é€šè¿‡é€‚é…å™¨æ¨¡å¼æˆ‘ä»¬å¯ä»¥é€šè¿‡åˆ›å»ºé€‚é…å™¨æ¨¡å¼åœ¨ä¸ä¿®æ”¹åŸæœ‰ç±»ä»£ç çš„æƒ…å†µä¸‹å®ç°æ–°çš„åŠŸèƒ½ã€‚</p>
<pre><code>class Computer:
    def __init__(self, name):
        self.name = name

    def __str__(self):
        return &apos;the {} computer&apos;.format(self.name)

    def execute(self):
        &quot;&quot;&quot; call by client code &quot;&quot;&quot;
        return &apos;execute a program&apos;


class Synthesizer:
    def __init__(self, name):
        self.name = name

    def __str__(self):
        return &apos;the {} synthesizer&apos;.format(self.name)

    def play(self):
        return &apos;is playing an electroinc song&apos;


class Human:
    def __init__(self, name):
        self.name = name

    def __str__(self):
        return &apos;the {} human&apos;.format(self.name)

    def speak(self):
        return &apos;says hello&apos;


class Adapter:
    def __init__(self, obj, adapted_methods):
        &quot;&quot;&quot; ä¸ä½¿ç”¨ç»§æ‰¿ï¼Œä½¿ç”¨__dict__å±æ€§å®ç°é€‚é…å™¨æ¨¡å¼ &quot;&quot;&quot;
        self.obj = obj
        self.__dict__.update(adapted_methods)

    def __str__(self):
        return str(self.obj)


# é€‚é…å™¨ä½¿ç”¨ç¤ºä¾‹
def main():
    objs = [Computer(&apos;Asus&apos;)]
    synth = Synthesizer(&apos;moog&apos;)
    objs.append(Adapter(synth, dict(execute=synth.play)))
    human = Human(&apos;Wnn&apos;)
    objs.append(Adapter(human, dict(execute=human.speak)))

    for o in objs:
        # ç”¨ç»Ÿä¸€çš„executeé€‚é…ä¸åŒå¯¹è±¡çš„æ–¹æ³•ï¼Œè¿™æ ·åœ¨æ— éœ€ä¿®æ”¹æºå¯¹è±¡çš„æƒ…å†µä¸‹å°±å®ç°äº†ä¸åŒå¯¹è±¡æ–¹æ³•çš„é€‚é…
        print(&apos;{} {}&apos;.format(str(o), o.execute()))


if __name__ == &quot;__main__&quot;:
    main()
</code></pre><hr>
<h2 id="5-The-Decorator-Pattern-è£…é¥°å™¨æ¨¡å¼ï¼š-æ— éœ€å­ç±»åŒ–å®ç°æ‰©å±•å¯¹è±¡åŠŸèƒ½é—®é¢˜"><a href="#5-The-Decorator-Pattern-è£…é¥°å™¨æ¨¡å¼ï¼š-æ— éœ€å­ç±»åŒ–å®ç°æ‰©å±•å¯¹è±¡åŠŸèƒ½é—®é¢˜" class="headerlink" title="5: The Decorator Pattern(è£…é¥°å™¨æ¨¡å¼ï¼š æ— éœ€å­ç±»åŒ–å®ç°æ‰©å±•å¯¹è±¡åŠŸèƒ½é—®é¢˜)"></a>5: The Decorator Pattern(è£…é¥°å™¨æ¨¡å¼ï¼š æ— éœ€å­ç±»åŒ–å®ç°æ‰©å±•å¯¹è±¡åŠŸèƒ½é—®é¢˜)</h2><p>é€šå¸¸ç»™ä¸€ä¸ªå¯¹è±¡æ·»åŠ æ–°åŠŸèƒ½æœ‰ä¸‰ç§æ–¹å¼ï¼š</p>
<ul>
<li>ç›´æ¥ç»™å¯¹è±¡æ‰€å±çš„ç±»æ·»åŠ æ–¹æ³•ã€‚</li>
<li>ä½¿ç”¨ã€ç»„åˆã€</li>
<li>ä½¿ç”¨ã€ç»§æ‰¿ã€ï¼Œä¼˜å…ˆä½¿ç”¨ç»„åˆè€Œéç»§æ‰¿ã€‚<br>è£…é¥°å™¨æ¨¡å¼æä¾›äº†ç¬¬å››ç§é€‰æ‹©ï¼Œé€šè¿‡åŠ¨æ€æ”¹å˜å¯¹è±¡æ‰©å±•å¯¹è±¡åŠŸèƒ½ã€‚å…¶ä»–ç¼–ç¨‹è¯­è¨€é€šå¸¸ä½¿ç”¨ç»§æ‰¿å®ç°è£…é¥°å™¨è£…é¥°å™¨æ¨¡å¼ï¼Œè€Œpythonå†…ç½®äº†è£…é¥°å™¨ã€‚è£…é¥°å™¨æœ‰å¾ˆå¤šç”¨é€”ï¼Œæ¯”å¦‚æ•°æ®æ ¡éªŒï¼Œäº‹åŠ¡å¤„ç†ï¼Œç¼“å­˜ï¼Œæ—¥å¿—ç­‰ã€‚æ¯”å¦‚ç”¨è£…é¥°å™¨å®ç°ä¸€ä¸ªç®€å•çš„ç¼“å­˜ï¼Œpython3.5è‡ªå¸¦äº†functools.lru_cache</li>
</ul>
<pre><code>from functools import wraps

def memoize(fn):
    known = dict()

    @wraps(fn)
    def memoizer(*args):
        if args not in known:
            known[args] = fn(*args)
        return known[args]
    return memoizer


@memoize
def fibonacci(n):
    assert(n &gt;= 0), &apos;n must be &gt;= 0&apos;
    return n if n in (0, 1) else fibonacci(n-1) + fibonacci(n-2)
</code></pre><hr>
<h2 id="6-The-Facade-Pattern-å¤–è§‚æ¨¡å¼-ç®€åŒ–å¤æ‚å¯¹è±¡çš„è®¿é—®é—®é¢˜"><a href="#6-The-Facade-Pattern-å¤–è§‚æ¨¡å¼-ç®€åŒ–å¤æ‚å¯¹è±¡çš„è®¿é—®é—®é¢˜" class="headerlink" title="6: The Facade Pattern(å¤–è§‚æ¨¡å¼: ç®€åŒ–å¤æ‚å¯¹è±¡çš„è®¿é—®é—®é¢˜)"></a>6: The Facade Pattern(å¤–è§‚æ¨¡å¼: ç®€åŒ–å¤æ‚å¯¹è±¡çš„è®¿é—®é—®é¢˜)</h2><p>å¤–è§‚æ¨¡å¼ç”¨æ¥ç®€åŒ–å¤æ‚ç³»ç»Ÿçš„è®¿é—®ã€‚é€šè¿‡ç®€åŒ–çš„æ¥å£åªè®¿é—®éœ€è¦çš„éƒ¨åˆ†ï¼Œéšè—ç³»ç»Ÿå¤æ‚æ€§ã€‚æƒ³è±¡ä¸€ä¸‹å…¬å¸æ¥çº¿å‘˜ï¼Œè™½ç„¶å…¬å¸å†…éƒ¨è¿è¡Œæœºåˆ¶æ¯”è¾ƒå¤æ‚ï¼Œä½†æ˜¯æ¥çº¿å‘˜å¯ä»¥è¿…é€Ÿå¸®ä½ è§£å†³ç‰¹å®šé—®é¢˜ã€‚ æˆ‘ä»¬ä»¥å®ç°ä¸ªç®€å•çš„æ“ä½œç³»ç»Ÿç¤ºä¾‹è¯´æ˜å¤–è§‚æ¨¡å¼ï¼š</p>
<pre><code>from abc import ABCMeta, abstractmethod
from enum import Enum

State = Enum(&apos;State&apos;, &apos;new running sleeping restart zombie&apos;)


class Server(metaclass=ABCMeta):
    &quot;&quot;&quot; æŠ½è±¡åŸºç±» &quot;&quot;&quot;
    @abstractmethod
    def __init__(self):
        pass

    def __str__(self):
        return self.name

    @abstractmethod
    def boot(self):
        pass

    @abstractmethod
    def kill(self, restart=True):
        pass


class FileServer(Server):
    def __init__(self):
        &apos;&apos;&apos;actions required for initializing the file server&apos;&apos;&apos;
        self.name = &apos;FileServer&apos;
        self.state = State.new

    def boot(self):
        print(&apos;booting the {}&apos;.format(self))
        &apos;&apos;&apos;actions required for booting the file server&apos;&apos;&apos;
        self.state = State.running

    def kill(self, restart=True):
        print(&apos;Killing {}&apos;.format(self))
        &apos;&apos;&apos;actions required for killing the file server&apos;&apos;&apos;
        self.state = State.restart if restart else State.zombie

    def create_file(self, user, name, permissions):
        &apos;&apos;&apos;check validity of permissions, user rights, etc.&apos;&apos;&apos;
        print(&quot;trying to create the file &apos;{}&apos; for user &apos;{}&apos; with permissions {}&quot;.format(name, user, permissions))

class ProcessServer(Server):
    def __init__(self):
        &apos;&apos;&apos;actions required for initializing the process server&apos;&apos;&apos;
        self.name = &apos;ProcessServer&apos;
        self.state = State.new

    def boot(self):
        print(&apos;booting the {}&apos;.format(self))
        &apos;&apos;&apos;actions required for booting the process server&apos;&apos;&apos;
        self.state = State.running

    def kill(self, restart=True):
        print(&apos;Killing {}&apos;.format(self))
        &apos;&apos;&apos;actions required for killing the process server&apos;&apos;&apos;
        self.state = State.restart if restart else State.zombie

    def create_process(self, user, name):
        &apos;&apos;&apos;check user rights, generate PID, etc.&apos;&apos;&apos;
        print(&quot;trying to create the process &apos;{}&apos; for user &apos;{}&apos;&quot;.format(name, user))


class OperatingSystem:
    &apos;&apos;&apos; å®ç°å¤–è§‚æ¨¡å¼ï¼Œå¤–éƒ¨ä½¿ç”¨çš„ä»£ç ä¸å¿…çŸ¥é“ FileServer å’Œ ProcessServerçš„
    å†…éƒ¨æœºåˆ¶ï¼Œåªéœ€è¦é€šè¿‡ OperatingSystemç±»è°ƒç”¨&apos;&apos;&apos;
    def __init__(self):
        self.fs = FileServer()
        self.ps = ProcessServer()

    def start(self):
        &quot;&quot;&quot; è¢«å®¢æˆ·ç«¯ä»£ç ä½¿ç”¨ &quot;&quot;&quot;
        [i.boot() for i in (self.fs, self.ps)]

    def create_file(self, user, name, permissions):
        return self.fs.create_file(user, name, permissions)

    def create_process(self, user, name):
        return self.ps.create_process(user, name)

def main():
    os = OperatingSystem()
    os.start()
    os.create_file(&apos;foo&apos;, &apos;hello&apos;, &apos;-rw-r-r&apos;)
    os.create_process(&apos;bar&apos;, &apos;ls /tmp&apos;)

main()
</code></pre><hr>
<p>7: The Flyweight Pattern(äº«å…ƒæ¨¡å¼: å®ç°å¯¹è±¡å¤ç”¨ä»è€Œæ”¹å–„èµ„æºä½¿ç”¨ï¼‰</p>
<blockquote>
<p>Flyweight design pattern is a technique used to minimize memory usage and improve performance by introducing data sharing between similar objects.</p>
</blockquote>
<p>OOPç¼–ç¨‹ä¸­å®¹æ˜“å‡ºç°å¯¹è±¡åˆ›å»ºå¸¦æ¥çš„æ€§èƒ½å’Œå†…å­˜å ç”¨é—®é¢˜ï¼Œéœ€è¦æ»¡è¶³ä»¥ä¸‹æ¡ä»¶ï¼š</p>
<ul>
<li>éœ€è¦ä½¿ç”¨å¤§é‡å¯¹è±¡(pythoné‡Œæˆ‘ä»¬å¯ä»¥ç”¨<strong>slots</strong>èŠ‚çœå†…å­˜å ç”¨)</li>
<li>å¯¹è±¡å¤ªå¤šéš¾ä»¥å­˜å‚¨æˆ–è§£æå¤§é‡å¯¹è±¡ã€‚</li>
<li>å¯¹è±¡è¯†åˆ«ä¸æ˜¯ç‰¹åˆ«é‡è¦ï¼Œå…±äº«å¯¹è±¡ä¸­å¯¹è±¡æ¯”è¾ƒä¼šå¤±è´¥ã€‚</li>
</ul>
<pre><code># ä½¿ç”¨å¯¹è±¡æ± æŠ€æœ¯å®ç°äº«å…ƒæ¨¡å¼
import random
from enum import Enum
TreeType = Enum(&apos;TreeType&apos;, &apos;apple_tree cherry_tree peach_tree&apos;)


class Tree:
    pool = dict()

    def __new__(cls, tree_type):
        obj = cls.pool.get(tree_type, None)
        if obj is None:
            obj = object.__new__(cls)
            cls.pool[tree_type] = obj
            obj.tree_type = tree_type
        return obj

    def render(self, age, x, y):
        print(&apos;render a tree of type {} and age {} at ({}, {})&apos;.format(self.tree_type, age, x, y))


def main():
    rnd = random.Random()
    age_min, age_max = 1, 30    # in years
    min_point, max_point = 0, 100
    tree_counter = 0

    for _ in range(10):
        t1 = Tree(TreeType.apple_tree)
        t1.render(rnd.randint(age_min, age_max),
                rnd.randint(min_point, max_point),
                rnd.randint(min_point, max_point))
        tree_counter += 1

    for _ in range(3):
        t2 = Tree(TreeType.cherry_tree)
        t2.render(rnd.randint(age_min, age_max),
                rnd.randint(min_point, max_point),
                rnd.randint(min_point, max_point))
        tree_counter += 1

    for _ in range(5):
        t3 = Tree(TreeType.peach_tree)
        t3.render(rnd.randint(age_min, age_max),
                rnd.randint(min_point, max_point),
                rnd.randint(min_point, max_point))
        tree_counter += 1
    print(&apos;trees rendered: {}&apos;.format(tree_counter))
    print(&apos;trees actually created: {}&apos;.format(len(Tree.pool)))
    t4 = Tree(TreeType.cherry_tree)
    t5 = Tree(TreeType.cherry_tree)
    t6 = Tree(TreeType.apple_tree)
    print(&apos;{} == {}? {}&apos;.format(id(t4), id(t5), id(t4) == id(t5)))
    print(&apos;{} == {}? {}&apos;.format(id(t5), id(t6), id(t5) == id(t6)))


if __name__ == &apos;__main__&apos;:
    main()
</code></pre><hr>
<h2 id="8-The-Model-View-Controller-Pattern-mvcæ¨¡å¼ï¼šè§£è€¦å±•ç¤ºé€»è¾‘å’Œä¸šåŠ¡é€»è¾‘"><a href="#8-The-Model-View-Controller-Pattern-mvcæ¨¡å¼ï¼šè§£è€¦å±•ç¤ºé€»è¾‘å’Œä¸šåŠ¡é€»è¾‘" class="headerlink" title="8: The Model-View-Controller Pattern(mvcæ¨¡å¼ï¼šè§£è€¦å±•ç¤ºé€»è¾‘å’Œä¸šåŠ¡é€»è¾‘)"></a>8: The Model-View-Controller Pattern(mvcæ¨¡å¼ï¼šè§£è€¦å±•ç¤ºé€»è¾‘å’Œä¸šåŠ¡é€»è¾‘)</h2><blockquote>
<p>When using MVC, make sure that you creating smart models (core functionality), thin controllers (functionality required for the communication between the view and the controller), and dumb views (representation and minimal processing).</p>
</blockquote>
<p>MVCæ¨¡å¼æ—¢æ˜¯ä¸€ç§è®¾è®¡æ¨¡å¼ï¼Œä¹Ÿæ˜¯è½¯ä»¶æ¶æ„æ¨¡å¼ã€‚æ¯”å¦‚æµè¡Œçš„djangoæ¡†æ¶å°±æ˜¯mvc(MTV)æ¨¡å¼ã€‚Modelå±‚è´Ÿè´£å’Œæ•°æ®åº“äº¤äº’ï¼ŒViewå±‚è´Ÿè´£å±•ç°é€»è¾‘ï¼ŒControllerå±‚è´Ÿè´£ç²˜åˆModelå’ŒViewå±‚ï¼Œå°†å„ä¸ªéƒ¨åˆ†è§£è€¦ï¼Œä½¿ä»£ç æ›´æ˜“æ‰©å±•å’Œç»´æŠ¤ã€‚</p>
<pre><code>quotes = (&apos;A man is not complete until he is married. Then he is finished.&apos;,
        &apos;As I said before, I never repeat myself.&apos;,
        &apos;Behind a successful man is an exhausted woman.&apos;,
        &apos;Black holes really suck...&apos;, &apos;Facts are stubborn things.&apos;)


class QuoteModel:
    def get_quote(self, n):
        try:
            return quotes[n]
        except IndexError:
            return &apos;Not found&apos;


class QuoteTerminalView:

    def show(self, quote):
        print(&apos;And the quote is: &quot;{}&quot;&apos;.format(quote))

    def error(self, msg):
        print(&apos;Error: {}&apos;.format(msg))

    def select_quote(self):
        return input(&apos;Which quote number would you like to see? &apos;)



class QuoteTerminalController:
    def __init__(self):
        self.model = QuoteModel()
        self.view = QuoteTerminalView()

    def run(self):
        valid_input = False
        while not valid_input:
            n = self.view.select_quote()
            try:
                n = int(n)
            except ValueError:
                self.view.error(&quot;Incorrect index &apos;{}&apos;&quot;.format(n))
            else:
                valid_input = True
                quote = self.model.get_quote(n)
                self.view.show(quote)


def main():
    controller = QuoteTerminalController()
    while True:
        controller.run()
</code></pre><hr>
<h2 id="9-The-Proxy-Pattern-ä»£ç†æ¨¡å¼ï¼šé€šè¿‡ä¸€å±‚é—´æ¥ä¿æŠ¤å±‚å®ç°æ›´å®‰å…¨çš„æ¥å£è®¿é—®ï¼‰"><a href="#9-The-Proxy-Pattern-ä»£ç†æ¨¡å¼ï¼šé€šè¿‡ä¸€å±‚é—´æ¥ä¿æŠ¤å±‚å®ç°æ›´å®‰å…¨çš„æ¥å£è®¿é—®ï¼‰" class="headerlink" title="9: The Proxy Pattern(ä»£ç†æ¨¡å¼ï¼šé€šè¿‡ä¸€å±‚é—´æ¥ä¿æŠ¤å±‚å®ç°æ›´å®‰å…¨çš„æ¥å£è®¿é—®ï¼‰"></a>9: The Proxy Pattern(ä»£ç†æ¨¡å¼ï¼šé€šè¿‡ä¸€å±‚é—´æ¥ä¿æŠ¤å±‚å®ç°æ›´å®‰å…¨çš„æ¥å£è®¿é—®ï¼‰</h2><p>åœ¨è®¿é—®çœŸæ­£çš„å¯¹è±¡ä¹‹å‰åšä¸€äº›æ“ä½œã€‚æœ‰å››ç§å¸¸ç”¨çš„ä»£ç†ç±»å‹:</p>
<ul>
<li>A remote proxy.ä½¿å¾—è®¿é—®è¿œç¨‹å¯¹è±¡å°±åƒæœ¬åœ°è®¿é—®ä¸€æ ·ï¼Œä¾‹å¦‚ç½‘ç»œæœåŠ¡å™¨ã€‚éšè—å¤æ‚æ€§ï¼Œä½¿å¾—è®¿é—®æœ¬åœ°è¿œç¨‹ç»Ÿä¸€ã€‚æ¯”å¦‚ORM</li>
<li>A virtual proxyã€‚ç”¨æ¥å®ç°å»¶è¿Ÿè®¿é—®ï¼Œæ¯”å¦‚ä¸€äº›éœ€è¦å¤æ‚è®¡ç®—çš„å¯¹è±¡ï¼Œpythoné‡Œå¯ä»¥å®ç°lazy_propertyï¼Œæ€§èƒ½æ”¹å–„</li>
<li>A protection/protective proxy. æ§åˆ¶æ•æ„Ÿå¯¹è±¡çš„è®¿é—®ï¼ŒåŠ ä¸Šä¸€å±‚ä¿æŠ¤å±‚ï¼Œå®ç°å®‰å…¨æ§åˆ¶</li>
<li>A smart(reference) proxy. è®¿é—®å¯¹è±¡æ—¶åŠ ä¸Šä¸€å±‚é¢å¤–æ“ä½œï¼Œä¾‹å¦‚å¼•ç”¨è®¡æ•°å’Œçº¿ç¨‹å®‰å…¨æ£€æŸ¥ã€‚weakref.proxy()</li>
</ul>
<p>ä»£ç†æ¨¡å¼çš„åŠŸèƒ½è¿˜æ˜¯å¾ˆå¼ºå¤§çš„ï¼Œå…ˆæ¥çœ‹çœ‹ä½¿ç”¨æè¿°ç¬¦å®ç°LazyPropertyï¼Œåœ¨å¯¹è±¡åˆ›å»ºä»¥åç¬¬ä¸€æ¬¡è®¿é—®æ‰ä¼šçœŸæ­£ç”Ÿæˆ</p>
<pre><code>class LazyProperty:
    &quot;&quot;&quot; ç”¨æè¿°ç¬¦å®ç°å»¶è¿ŸåŠ è½½çš„å±æ€§ &quot;&quot;&quot;
    def __init__(self, method):
        self.method = method
        self.method_name = method.__name__

    def __get__(self, obj, cls):
        if not obj:
            return None
        value = self.method(obj)
        print(&apos;value {}&apos;.format(value))
        setattr(obj, self.method_name, value)
        return value


class Test:
    def __init__(self):
        self.x = &apos;foo&apos;
        self.y = &apos;bar&apos;
        self._resource = None

    @LazyProperty
    def resource(self):    # æ„é€ å‡½æ•°é‡Œæ²¡æœ‰åˆå§‹åŒ–ï¼Œç¬¬ä¸€æ¬¡è®¿é—®æ‰ä¼šè¢«è°ƒç”¨
        print(&apos;initializing self._resource which is: {}&apos;.format(self._resource))
        self._resource = tuple(range(5))    # æ¨¡æ‹Ÿä¸€ä¸ªè€—æ—¶è®¡ç®—
        return self._resource


def main():
    t = Test()
    print(t.x)
    print(t.y)
    # è®¿é—®LazyProperty, resourceé‡Œçš„printè¯­å¥åªæ‰§è¡Œä¸€æ¬¡ï¼Œå®ç°äº†å»¶è¿ŸåŠ è½½å’Œä¸€æ¬¡æ‰§è¡Œ
    print(t.resource)
    print(t.resource)


main()
</code></pre><p>å†çœ‹é‚£ä¸ªç”¨ä»£ç†å®ç°å®‰å…¨æ§åˆ¶çš„ä¾‹å­ï¼Œæˆ‘ä»¬ç»™SensitiveInfoé‡Œçš„addæ“ä½œåŠ ä¸Šå¯†é’¥éªŒè¯ï¼Œä¾‹å­ä¹Ÿå¾ˆç®€å•</p>
<pre><code>class SensitiveInfo:
    def __init__(self):
        self.users = [&apos;nick&apos;, &apos;tom&apos;, &apos;ben&apos;, &apos;mike&apos;]

    def read(self):
        print(&apos;There are {} users: {}&apos;.format(len(self.users), &apos; &apos;.join(self.users)))

    def add(self, user):
        self.users.append(user)
        print(&apos;Added user {}&apos;.format(user))


class Info:
    &apos;&apos;&apos;protection proxy to SensitiveInfo&apos;&apos;&apos;
    def __init__(self):
        self.protected = SensitiveInfo()
        # ä¸ºäº†æ–¹ä¾¿ç¤ºä¾‹è¿™é‡Œç›´æ¥å†™æ­»åœ¨ä»£ç é‡Œï¼Œä¸ºäº†å®‰å…¨ä¸åº”è¯¥è¿™ä¹ˆåš
        self.secret = &apos;0xdeadbeef&apos;

    def read(self):
        self.protected.read()

    def add(self, user):
        &quot;&quot;&quot; ç»™addæ“ä½œåŠ ä¸Šå¯†é’¥éªŒè¯ï¼Œä¿æŠ¤addæ“ä½œ&quot;&quot;&quot;
        sec = input(&apos;what is the secret? &apos;)
        self.protected.add(user) if sec == self.secret else print(&quot;That&apos;s wrong!&quot;)


def main():
    info = Info()
    while True:
        print(&apos;1. read list |==| 2. add user |==| 3. quit&apos;)
        key = input(&apos;choose option: &apos;)
        if key == &apos;1&apos;:
            info.read()
        elif key == &apos;2&apos;:
            name = input(&apos;choose username: &apos;)
            info.add(name)
        elif key == &apos;3&apos;:
            exit()
        else:
            print(&apos;unknown option: {}&apos;.format(key))
main()
</code></pre><p>ä¸Šé¢è¿™ä¸ªç¤ºä¾‹æœ‰å‡ ä¸ªç¼ºç‚¹</p>
<ol>
<li>SensitiveInfoå¯ä»¥è¢«ç›´æ¥å®ä¾‹åŒ–ä½¿ç”¨ï¼Œç»•è¿‡Infoç±»ï¼Œå¯ä»¥è€ƒè™‘ä½¿ç”¨abcæ¨¡å—é¿å…SensitiveInfoè¢«ç›´æ¥å®ä¾‹åŒ–</li>
<li>å¯†é’¥ç›´æ¥å†™æ­»åœ¨ä»£ç é‡Œï¼Œåº”è¯¥ç”¨å®‰å…¨æ€§è¾ƒé«˜å¯†é’¥å†™åˆ°é…ç½®æˆ–è€…ç¯å¢ƒå˜é‡é‡Œ</li>
</ol>
<p>æˆ‘ä»¬ä½¿ç”¨æŠ½è±¡åŸºç±»æ¥ä¿®æ­£ç¬¬ä¸€ä¸ªç¼ºé™·ï¼Œåªéœ€è¦ä¿®æ­£ç±»ä»£ç è€Œä¸ç”¨æ”¹mainå‡½æ•°é‡Œçš„ä½¿ç”¨ä»£ç </p>
<pre><code>from abc import ABCMeta, abstractmethod


class SensitiveInfo(metaclass=ABCMeta):
    def __init__(self):
        self.users = [&apos;nick&apos;, &apos;tom&apos;, &apos;ben&apos;, &apos;mike&apos;]

    @abstractmethod
    def read(self):
        pass

    @abstractmethod
    def add(self, user):
        pass


class Info(SensitiveInfo):
    &apos;&apos;&apos;protection proxy to SensitiveInfo&apos;&apos;&apos;
    def __init__(self):
        # self.protected = SensitiveInfo()
        super().__init__()
        self.secret = &apos;0xdeadbeef&apos;    # ä¸ºäº†æ–¹ä¾¿ç¤ºä¾‹è¿™é‡Œç›´æ¥å†™æ­»åœ¨ä»£ç é‡Œ

    def read(self):
        print(&apos;There are {} users: {}&apos;.format(len(self.users), &apos; &apos;.join(self.users)))

    def add(self, user):
        &quot;&quot;&quot; ç»™addæ“ä½œåŠ ä¸Šå¯†é’¥éªŒè¯ï¼Œä¿æŠ¤addæ“ä½œ&quot;&quot;&quot;
        sec = input(&apos;what is the secret? &apos;)
        self.users.append(user) if sec == self.secret else print(&quot;That&apos;s wrong!&quot;)
</code></pre><hr>
<h2 id="10-The-Chain-of-Responsibility-Pattern-è´£ä»»é“¾æ¨¡å¼-åˆ›å»ºé“¾å¼å¯¹è±¡ç”¨æ¥æ¥æ”¶å¹¿æ’­æ¶ˆæ¯"><a href="#10-The-Chain-of-Responsibility-Pattern-è´£ä»»é“¾æ¨¡å¼-åˆ›å»ºé“¾å¼å¯¹è±¡ç”¨æ¥æ¥æ”¶å¹¿æ’­æ¶ˆæ¯" class="headerlink" title="10: The Chain of Responsibility Pattern (è´£ä»»é“¾æ¨¡å¼:åˆ›å»ºé“¾å¼å¯¹è±¡ç”¨æ¥æ¥æ”¶å¹¿æ’­æ¶ˆæ¯)"></a>10: The Chain of Responsibility Pattern (è´£ä»»é“¾æ¨¡å¼:åˆ›å»ºé“¾å¼å¯¹è±¡ç”¨æ¥æ¥æ”¶å¹¿æ’­æ¶ˆæ¯)</h2><blockquote>
<p>The Chain of Responsibility pattern is used when we want to give a chance to multiple objects to satisfy a single request, or when we donâ€™t know which object (from a chain of objects) should process a specific request in advance.</p>
</blockquote>
<p>å¼€å§‹ä»‹ç»è¡Œä¸ºå‹è®¾è®¡æ¨¡å¼ï¼Œè¡Œä¸ºå‹è®¾è®¡æ¨¡å¼å¤„ç†å¯¹è±¡ä¹‹é—´çš„äº¤äº’å’Œç®—æ³•é—®é¢˜ã€‚åœ¨è´£ä»»è¿æ¨¡å¼ä¸­ï¼Œæˆ‘ä»¬æŠŠæ¶ˆæ¯å‘é€ç»™ä¸€ç³»åˆ—å¯¹è±¡çš„é¦–ä¸ªèŠ‚ç‚¹ï¼Œå¯¹è±¡å¯ä»¥é€‰æ‹©å¤„ç†æ¶ˆæ¯æˆ–è€…å‘ä¸‹ä¸€ä¸ªå¯¹è±¡ä¼ é€’,åªæœ‰å¯¹æ¶ˆæ¯æ„Ÿå…´è¶£çš„èŠ‚ç‚¹å¤„ç†ã€‚ç”¨æ¥è§£è€¦å‘é€è€…å’Œæ¥æ”¶è€…ã€‚åœ¨pythoné‡Œé€šè¿‡dynamic dispatchingæ¥å®ç°ï¼Œä»¥ä¸€ä¸ªäº‹ä»¶é©±åŠ¨ç³»ç»Ÿæ¥è¯´æ˜ï¼š</p>
<pre><code>class Event:
    def __init__(self, name):
        self.name = name

    def __str__(self):
        return self.name


class Widget:

    &quot;&quot;&quot;Docstring for Widget. &quot;&quot;&quot;

    def __init__(self, parent=None):
        self.parent = parent

    def handle(self, event):
        handler = &apos;handle_{}&apos;.format(event)
        if hasattr(self, handler):
            method = getattr(self, handler)
            method(event)
        elif self.parent:
            self.parent.handle(event)
        elif hasattr(self, &apos;handle_default&apos;):
            self.handle_default(event)


class MainWindow(Widget):
    def handle_close(self, event):
        print(&apos;MainWindow: {}&apos;.format(event))

    def handle_default(self, event):
        print(&apos;MainWindow: Default {}&apos;.format(event))


class SendDialog(Widget):
    def handle_paint(self, event):
        print(&apos;SendDialog: {}&apos;.format(event))


class MsgText(Widget):
    def handle_down(self, event):
        print(&apos;MsgText: {}&apos;.format(event))


def main():
    mw = MainWindow()
    sd = SendDialog(mw)    # parentæ˜¯mw
    msg = MsgText(sd)

    for e in (&apos;down&apos;, &apos;paint&apos;, &apos;unhandled&apos;, &apos;close&apos;):
        evt = Event(e)
        print(&apos;\nSending event -{}- to MainWindow&apos;.format(evt))
        mw.handle(evt)
        print(&apos;Sending event -{}- to SendDialog&apos;.format(evt))
        sd.handle(evt)
        print(&apos;Sending event -{}- to MsgText&apos;.format(evt))
        msg.handle(evt)

if __name__ == &quot;__main__&quot;:
    main()
</code></pre><hr>
<h2 id="11-The-Command-Pattern-å‘½ä»¤æ¨¡å¼ï¼šç”¨æ¥ç»™åº”ç”¨æ·»åŠ Undoæ“ä½œ"><a href="#11-The-Command-Pattern-å‘½ä»¤æ¨¡å¼ï¼šç”¨æ¥ç»™åº”ç”¨æ·»åŠ Undoæ“ä½œ" class="headerlink" title="11: The Command Pattern(å‘½ä»¤æ¨¡å¼ï¼šç”¨æ¥ç»™åº”ç”¨æ·»åŠ Undoæ“ä½œ)"></a>11: The Command Pattern(å‘½ä»¤æ¨¡å¼ï¼šç”¨æ¥ç»™åº”ç”¨æ·»åŠ Undoæ“ä½œ)</h2><p>å‘½ä»¤æ¨¡å¼å¸®åŠ©æˆ‘ä»¬æŠŠä¸€ä¸ªæ“ä½œ(undo,redo,copy,pasteç­‰)å°è£…æˆä¸€ä¸ªå¯¹è±¡ï¼Œé€šå¸¸æ˜¯åˆ›å»ºä¸€ä¸ªåŒ…å«Operationæ‰€æœ‰é€»è¾‘å’Œæ–¹æ³•çš„ç±»ã€‚<br>é€šè¿‡å‘½ä»¤æ¨¡å¼å¯ä»¥æ§åˆ¶å‘½ä»¤çš„æ‰§è¡Œæ—¶é—´å’Œè¿‡ç¨‹ï¼Œè¿˜å¯ä»¥ç”¨æ¥ç»„ç»‡äº‹åŠ¡ã€‚ ç”¨ä¸€äº›æ–‡ä»¶æ“ä½œç±»æ¥è¯´æ˜å‘½ä»¤æ¨¡å¼çš„ä½¿ç”¨</p>
<pre><code>import os

class RenameFile:

    def __init__(self, path_src, path_dest):
        &quot;&quot;&quot; åœ¨inité‡Œä¿å­˜ä¸€äº›å¿…è¦ä¿¡æ¯ï¼Œæ¯”å¦‚undoéœ€è¦çš„è€çš„å’Œæ–°çš„æ–‡ä»¶å &quot;&quot;&quot;
        self.src, self.dest = path_src, path_dest

    def execute(self, verbose=False):
        if verbose:
            print(&quot;[renaming &apos;{}&apos; to &apos;{}&apos;]&quot;.format(self.src, self.dest))
        os.rename(self.src, self.dest)

    def undo(self, verbose=False):
        if verbose:
            print(&quot;[renaming &apos;{}&apos; back to &apos;{}&apos;]&quot;.format(self.dest, self.src))
        os.rename(self.dest, self.src)


def delete_file(path, verbose=False):
    if verbose:
        print(&quot;deleting file &apos;{}&quot;.format(path))
    os.remove(path)


class CreateFile:
    def __init__(self, path, txt=&apos;hello world\n&apos;):
        self.path, self.txt = path, txt

    def execute(self, verbose=False):
        if verbose:
            print(&quot;[creating file &apos;{}&apos;]&quot;.format(self.path))
        with open(self.path, mode=&apos;w&apos;, encoding=&apos;utf-8&apos;) as out_file:
            out_file.write(self.txt)

    def undo(self):
        delete_file(self.path)


class ReadFile:
    def __init__(self, path):
        self.path = path

    def execute(self, verbose=False):
        if verbose:
            print(&quot;[reading file &apos;{}&apos;]&quot;.format(self.path))
        with open(self.path, mode=&apos;r&apos;, encoding=&apos;utf-8&apos;) as in_file:
            print(in_file.read(), end=&apos;&apos;)


def main():
    orig_name, new_name = &apos;file1&apos;, &apos;file2&apos;
    commands = []
    for cmd in CreateFile(orig_name), ReadFile(orig_name), RenameFile(orig_name, new_name):
        commands.append(cmd)
    [c.execute() for c in commands]

    answer = input(&apos;reverse the executed commands? [y/n] &apos;)
    if answer not in &apos;yY&apos;:
        print(&quot;the result is {}&quot;.format(new_name))
        exit()
    for c in reversed(commands):
        try:
            c.undo()   # æ‰§è¡Œundo
        except AttributeError:
            pass

main()
</code></pre><hr>
<h2 id="12-The-Interpreter-Pattern-è§£é‡Šå™¨æ¨¡å¼ï¼šç”¨æ¥å®ç°Domain-Specific-Language-DSL"><a href="#12-The-Interpreter-Pattern-è§£é‡Šå™¨æ¨¡å¼ï¼šç”¨æ¥å®ç°Domain-Specific-Language-DSL" class="headerlink" title="12: The Interpreter Pattern(è§£é‡Šå™¨æ¨¡å¼ï¼šç”¨æ¥å®ç°Domain Specific Language(DSL))"></a>12: The Interpreter Pattern(è§£é‡Šå™¨æ¨¡å¼ï¼šç”¨æ¥å®ç°Domain Specific Language(DSL))</h2><p>æœ¬ç« æˆ‘ä»¬å®ç°ä¸€ä¸ªç®€å•çš„æ§åˆ¶å¤§é—¨Gateç±»çš„DSLã€‚ä½¿ç”¨<a href="http://infohost.nmt.edu/tcc/help/pubs/pyparsing/web/index.html" target="_blank" rel="noopener">pyparsing</a>æ¥è§£ææˆ‘ä»¬å®šä¹‰çš„æ§åˆ¶å¤§é—¨çš„è¯­æ³•å‘½ä»¤ã€‚<br>pyparsingè‡ªå¸¦äº†å¾ˆå¤šæœ‰ç”¨çš„å‡½æ•°å’Œç±»å¸®åŠ©æˆ‘ä»¬ä»æ–‡æœ¬ä¸­æŠ½å–éœ€è¦çš„ä¿¡æ¯ï¼Œæ¯”å¦‚æˆ‘ä»¬æ–¹ä¾¿åœ°å¤„ç†c++æºæ–‡ä»¶ä¸­çš„æ³¨é‡Š:(<code>pip install pyparsing</code>)</p>
<pre><code>&gt;&gt;&gt; text = &apos;// Look out of the yard? What will we see?&apos;
&gt;&gt;&gt; print pp.cppStyleComment.parseString(text)
[&apos;// Look out of the yard? What will we see?&apos;]
&gt;&gt;&gt; print pp.cppStyleComment.parseString(&apos;/* Author: R. J. Gumby */&apos;)
[&apos;/* Author: R. J. Gumby */&apos;]
</code></pre><p>å†æ¯”å¦‚æˆ‘ä»¬ä¸€å¥è¯å°±å¯ä»¥å»é™¤C++æºç ä¸­çš„æ³¨é‡Š:</p>
<pre><code>from pyparsing import cppStyleComment
code = &quot;&quot;&quot;
/* Hello World program */

#include&lt;stdio.h&gt;

main()
{
    printf(&quot;Hello World&quot;);    // print hello

}
&quot;&quot;&quot;
print(cppStyleComment.suppress().transformString(code))
</code></pre><p>ä¸‹é¢å®ç°æˆ‘ä»¬çš„æ§åˆ¶Gateçš„DSL</p>
<pre><code>from pyparsing import Word, OneOrMore, Optional, Group, Suppress, alphanums

class Gate:
    def __init__(self):
        self.is_open = False

    def __str__(self):
        return &apos;open&apos; if self.is_open else &apos;closed&apos;

    def open(self):
        print(&apos;opening the gate&apos;)
        self.is_open = True

    def close(self):
        print(&apos;closing the gate&apos;)
        self.is_open = False


def main():
    # é¦–å…ˆå®šä¹‰æˆ‘ä»¬çš„DSLæ ¼å¼ï¼Œæˆ‘ä»¬è¿™é‡Œæœ€ç®€å•çš„æ§åˆ¶è¯­æ³•å°±æ˜¯   &quot;open -&gt; gate&quot;
    word = Word(alphanums)
    command = Group(OneOrMore(word))
    token = Suppress(&quot;-&gt;&quot;)
    device = Group(OneOrMore(word))
    argument = Group(OneOrMore(word))
    event = command + token + device + Optional(token + argument)

    gate = Gate()
    cmds = [&apos;open -&gt; gate&apos;, &apos;close -&gt; gate&apos;]    # ä¸¤ä¸ªè‡ªå®šä¹‰çš„å‘½ä»¤
    open_actions = {&apos;gate&apos;: gate.open}
    close_actions = {&apos;gate&apos;: gate.close}

    for cmd in cmds:
        print(event.parseString(cmd))    # [[&apos;open&apos;], [&apos;gate&apos;]]
        cmd, dev = event.parseString(cmd)
        cmd_str, dev_str = &apos; &apos;.join(cmd), &apos; &apos;.join(dev)
        print(cmd_str, dev_str)
        if &apos;open&apos; in cmd_str:
            open_actions[dev_str]()
        elif &apos;close&apos; in cmd_str:
            close_actions[dev_str]()

if __name__ == &quot;__main__&quot;:
    main()
</code></pre><p>è¿™æ ·å°±å®ç°äº†ä¸€ä¸ªç®€å•çš„å¤§é—¨æ§åˆ¶è¯­è¨€ï¼Œä¸è¿‡åŠŸèƒ½å¾ˆå¼±ã€‚</p>
<hr>
<h2 id="13-The-Observer-Pattern-å‘å¸ƒè®¢é˜…æ¨¡å¼ï¼šç”¨æ¥å¤„ç†å¤šä¸ªå¯¹è±¡ä¹‹é—´çš„å‘å¸ƒè®¢é˜…é—®é¢˜"><a href="#13-The-Observer-Pattern-å‘å¸ƒè®¢é˜…æ¨¡å¼ï¼šç”¨æ¥å¤„ç†å¤šä¸ªå¯¹è±¡ä¹‹é—´çš„å‘å¸ƒè®¢é˜…é—®é¢˜" class="headerlink" title="13: The Observer Pattern(å‘å¸ƒè®¢é˜…æ¨¡å¼ï¼šç”¨æ¥å¤„ç†å¤šä¸ªå¯¹è±¡ä¹‹é—´çš„å‘å¸ƒè®¢é˜…é—®é¢˜)"></a>13: The Observer Pattern(å‘å¸ƒè®¢é˜…æ¨¡å¼ï¼šç”¨æ¥å¤„ç†å¤šä¸ªå¯¹è±¡ä¹‹é—´çš„å‘å¸ƒè®¢é˜…é—®é¢˜)</h2><p>å¦‚æœç”¨è¿‡blinkeråº“æˆ–è€…redisçš„pubï¼Œsubï¼Œå¯¹å‘å¸ƒè®¢é˜…åº”è¯¥ä¼šæ¯”è¾ƒç†Ÿæ‚‰ã€‚è¯¥æ¨¡å¼ç”¨åœ¨å½“ä¸€ä¸ªå¯¹è±¡çš„çŠ¶æ€å˜æ›´éœ€è¦é€šçŸ¥å…¶ä»–å¾ˆå¤šå¯¹è±¡çš„æ—¶å€™ï¼Œæ¯”å¦‚rssè®¢é˜…æˆ–è€…åœ¨ç¤¾äº¤ç½‘ç«™ä¸Šè®¢é˜…æŸä¸ªé¢‘é“çš„æ›´æ–°ã€‚äº‹ä»¶é©±åŠ¨ç³»ç»Ÿä¹Ÿæ˜¯ä¸€ç§å‘å¸ƒè®¢é˜…æ¨¡å¼ï¼Œäº‹ä»¶ä½œä¸ºå‘å¸ƒè€…ï¼Œç›‘å¬å™¨ä½œä¸ºè®¢é˜…è€…ï¼Œåªä¸è¿‡è¿™é‡Œå¤šä¸ªäº‹ä»¶ç›‘å¬å™¨å¯ä»¥ç›‘å¬åŒä¸€ä¸ªäº‹ä»¶ã€‚<br>æˆ‘ä»¬è¿™é‡Œå®ç°ä¸€ä¸ªâ€Data Formatterâ€æ¥è§£é‡Šå‘å¸ƒè®¢é˜…æ¨¡å¼ï¼Œä¸€ç§æ•°æ®å¯ä»¥æœ‰å¤šä¸ªæ ¼å¼åŒ–Formatterï¼Œå½“æ•°æ®æ›´æ–°çš„æ—¶å€™ï¼Œä¼šé€šçŸ¥æ‰€æœ‰çš„Formatteræ ¼å¼åŒ–æ–°çš„æ•°æ®ã€‚ä½¿ç”¨ç»§æ‰¿æ¥å®ç°ã€‚</p>
<pre><code>class Publisher:
    def __init__(self):
        self.observers = []

    def add(self, observer):
        if observer not in self.observers:
            self.observers.append(observer)
        else:
            print(&apos;Failed to add : {}&apos;).format(observer)

    def remove(self, observer):
        try:
            self.observers.remove(observer)
        except ValueError:
            print(&apos;Failed to remove : {}&apos;).format(observer)

    def notify(self):
        [o.notify_by(self) for o in self.observers]


class DefaultFormatter(Publisher):
    def __init__(self, name):
        super().__init__()
        self.name = name
        self._data = 0

    def __str__(self):
        return &quot;{}: &apos;{}&apos; has data = {}&quot;.format(
            type(self).__name__, self.name, self._data)

    @property
    def data(self):
        return self._data

    @data.setter
    def data(self, new_value):
        try:
            self._data = int(new_value)
        except ValueError as e:
            print(&apos;Error: {}&apos;.format(e))
        else:
            self.notify()    # data åœ¨è¢«åˆæ³•èµ‹å€¼ä»¥åä¼šæ‰§è¡Œnotify


class HexFormatter:
    &quot;&quot;&quot; è®¢é˜…è€… &quot;&quot;&quot;
    def notify_by(self, publisher):
        print(&quot;{}: &apos;{}&apos; has now hex data = {}&quot;.format(
            type(self).__name__, publisher.name, hex(publisher.data)))


class BinaryFormatter:
    &quot;&quot;&quot; è®¢é˜…è€… &quot;&quot;&quot;
    def notify_by(self, publisher):
        print(&quot;{}: &apos;{}&apos; has now bin data = {}&quot;.format(
            type(self).__name__, publisher.name, bin(publisher.data)))


if __name__ == &quot;__main__&quot;:
    df = DefaultFormatter(&apos;test1&apos;)
    print(df)
    print()
    hf = HexFormatter()
    df.add(hf)
    df.data = 3
    print(df)

    print()
    bf = BinaryFormatter()
    df.add(bf)
    df.data = 21
    print(df)
</code></pre><hr>
<h2 id="14-The-State-Pattern-çŠ¶æ€æ¨¡å¼ï¼šå®ç°æœ‰é™çŠ¶æ€æœº"><a href="#14-The-State-Pattern-çŠ¶æ€æ¨¡å¼ï¼šå®ç°æœ‰é™çŠ¶æ€æœº" class="headerlink" title="14: The State Pattern(çŠ¶æ€æ¨¡å¼ï¼šå®ç°æœ‰é™çŠ¶æ€æœº)"></a>14: The State Pattern(çŠ¶æ€æ¨¡å¼ï¼šå®ç°æœ‰é™çŠ¶æ€æœº)</h2><blockquote>
<p>A state machine is an abstract machine that has two key components: states and transitions. A state is the current (active) status of a system. A transition is the switch from one state to another. A state meachine has only one active state at a specific point in the time.<br>æˆ‘ä»¬é€šè¿‡å®ç°æ“ä½œç³»ç»Ÿä¸­è¿›ç¨‹çš„ç”Ÿå‘½å‘¨æœŸæ¥æ¼”ç¤ºçŠ¶æ€æ¨¡å¼çš„ä½¿ç”¨ï¼š</p>
</blockquote>
<pre><code># å…ˆè£…ä¸‹pip3 install state_machine
from state_machine import (
acts_as_state_machine, State, Event, before, after, InvalidStateTransition
)


@acts_as_state_machine
class Process:
    # å…ˆæ¥å®šä¹‰çŠ¶æ€æœºçš„çŠ¶æ€ states
    created = State(initial=True)    # åˆå§‹çŠ¶æ€
    waiting = State()
    running = State()
    terminated = State()
    blocked = State()
    swapped_out_waiting = State()
    swapped_out_blocked = State()

    # å†å®šä¹‰çŠ¶æ€æœºçš„è½¬ç§» transitions
    wait = Event(from_states=(created, running, blocked,
                            swapped_out_waiting), to_state=waiting)
    run = Event(from_states=waiting, to_state=running)
    terminate = Event(from_states=running, to_state=terminated)
    block = Event(from_states=(running, swapped_out_blocked),
                to_state=blocked)
    swap_wait = Event(from_states=waiting, to_state=swapped_out_waiting)
    swap_block = Event(from_states=blocked, to_state=swapped_out_blocked)

    def __init__(self, name):
        self.name = name

    # The state_machine module provides us with the @before and @after
    # decorators that can be used to execute actions before or after a
    # transition occurs, respectfully.
    @after(&apos;wait&apos;)
    def wait_info(self):
        print(&apos;{} entered waiting mode&apos;.format(self.name))

    @after(&apos;run&apos;)
    def run_info(self):
        print(&apos;{} is running&apos;.format(self.name))

    @before(&apos;terminate&apos;)
    def terminate_info(self):
        print(&apos;{} terminated&apos;.format(self.name))

    @after(&apos;block&apos;)
    def block_info(self):
        print(&apos;{} is blocked&apos;.format(self.name))

    @after(&apos;swap_wait&apos;)
    def swap_wait_info(self):
        print(&apos;{} is swapped out and waiting&apos;.format(self.name))

    @after(&apos;swap_block&apos;)
    def swap_block_info(self):
        print(&apos;{} is swapped out and blocked&apos;.format(self.name))


def transition(process, event, event_name):
    &quot;&quot;&quot;
    Args:
        process (Process obj):
        event (Event obj): wait, run, terminate...
        event_name (str): name of event
    &quot;&quot;&quot;
    try:
        event()
    except InvalidStateTransition:
        print(&apos;Error: transition of {} from {} to {} failed&apos;.format(
            process.name, process.current_state, event_name))


def state_info(process):
    &quot;&quot;&quot; å½“å‰çŠ¶æ€æœºçš„çŠ¶æ€ &quot;&quot;&quot;
    print(&apos;state of {}: {}&apos;.format(process.name, process.current_state))

if __name__ == &quot;__main__&quot;:
    RUNNING = &apos;running&apos;
    WAITING = &apos;waiting&apos;
    BLOCKED = &apos;blocked&apos;
    TERMINATED = &apos;terminated&apos;
    p1, p2 = Process(&apos;process1&apos;), Process(&apos;process2&apos;)
    [state_info(p) for p in (p1, p2)]

    print()
    transition(p1, p1.wait, WAITING)
    transition(p2, p2.terminate, TERMINATED)
    [state_info(p) for p in (p1, p2)]
    print()
    transition(p1, p1.run, RUNNING)
    transition(p2, p2.wait, WAITING)
    [state_info(p) for p in (p1, p2)]
    print()
    transition(p2, p2.run, RUNNING)
    [state_info(p) for p in (p1, p2)]
    print()
    [transition(p, p.block, BLOCKED) for p in (p1, p2)]
    [state_info(p) for p in (p1, p2)]
    print()
    [transition(p, p.terminate, TERMINATED) for p in (p1, p2)]
    [state_info(p) for p in (p1, p2)]
</code></pre><hr>
<h2 id="15-The-Strategy-Pattern-ç­–ç•¥æ¨¡å¼ï¼šåŠ¨æ€é€‰æ‹©ç®—æ³•ç­–ç•¥"><a href="#15-The-Strategy-Pattern-ç­–ç•¥æ¨¡å¼ï¼šåŠ¨æ€é€‰æ‹©ç®—æ³•ç­–ç•¥" class="headerlink" title="15: The Strategy Pattern(ç­–ç•¥æ¨¡å¼ï¼šåŠ¨æ€é€‰æ‹©ç®—æ³•ç­–ç•¥)"></a>15: The Strategy Pattern(ç­–ç•¥æ¨¡å¼ï¼šåŠ¨æ€é€‰æ‹©ç®—æ³•ç­–ç•¥)</h2><p>ç°å®ä¸­å¾€å¾€è§£å†³é—®é¢˜çš„æ–¹å¼ä¸æ­¢ä¸€ç§ï¼Œæˆ‘ä»¬å¯èƒ½éœ€è¦æ ¹æ®é—®é¢˜çš„ç‰¹å¾é€‰æ‹©æœ€ä¼˜çš„å®ç°ç­–ç•¥ï¼Œä»¥æ’åºç®—æ³•ä¸ºä¾‹å­ï¼ŒæŒ‘é€‰ä¸€ä¸ªåˆé€‚çš„æ’åºç®—æ³•çš„æ—¶å€™ï¼Œéœ€è¦è€ƒè™‘å¾…æ’åºæ•°ç»„çš„ä»¥ä¸‹ç‰¹å¾ï¼š</p>
<ul>
<li>å…ƒç´ ä¸ªæ•°ã€‚ç®—æ³•è¾“å…¥è§„æ¨¡ï¼Œå¤§éƒ¨åˆ†æ’åºç®—æ³•åœ¨è¾“å…¥è§„æ¨¡å¾ˆå°çš„æ—¶å€™æ•ˆç‡ç›¸å·®ä¸å¤§ï¼Œåªæœ‰ä¸€éƒ¨åˆ†nlognå¹³å‡æ—¶é—´å¤æ‚åº¦çš„é€‚åˆæ’åºå¤§è§„æ¨¡ã€‚</li>
<li>æœ€å¥½/å¹³å‡/æœ€åæ—¶é—´å¤æ‚åº¦.è¿™ä¸ªå¾€å¾€æ˜¯æŒ‘é€‰æ’åºç®—æ³•æ—¶å€™ä¼˜å…ˆè€ƒè™‘çš„ã€‚</li>
<li>ç©ºé—´å¤æ‚åº¦ã€‚æ˜¯ä¸æ˜¯åŸåœ°æ’åº(inplace),éœ€è¦é¢å¤–çš„ç©ºé—´å—ï¼Ÿåœ¨å†…å­˜é™åˆ¶è‹›åˆ»çš„æ—¶å€™å°±éœ€è¦è€ƒè™‘</li>
<li>ç¨³å®šæ€§ã€‚æ’åºç®—æ³•æ˜¯ç¨³å®šçš„å—ï¼Ÿç¨³å®šæ˜¯æŒ‡ç›¸åŒå¤§å°çš„å€¼æ’åºåä¿æŒç›¸å¯¹é¡ºåºã€‚</li>
<li>å®ç°å¤æ‚åº¦ã€‚ç®—æ³•æ˜¯å¦å®¹æ˜“å®ç°ï¼Œå…¶ä»–å¤§è‡´ç›¸åŒçš„æƒ…å†µä¸‹ï¼Œä¼˜å…ˆè€ƒè™‘æ˜“ç»´æŠ¤çš„ä»£ç ã€‚</li>
</ul>
<p>ç­–ç•¥æ¨¡å¼å…è®¸æˆ‘ä»¬æ ¹æ®å¾…å¤„ç†æ•°æ®çš„ç‰¹å¾çµæ´»é€‰ç”¨å½“å‰ç‰¹å¾ä¸‹æœ€ä¼˜çš„å®ç°ï¼Œæ¯”å¦‚å¸¸è§åº“çš„æ’åºç®—æ³•ä¸€èˆ¬éƒ½æ˜¯æ··åˆäº†å¤šç§æ’åºç®—æ³•çš„å®ç°ï¼Œpythonä½¿ç”¨çš„æ˜¯Tim Petersåœ¨2002å¹´è®¾è®¡çš„ç»“åˆäº†åˆå¹¶æ’åºå’Œæ’å…¥æ’åºçš„<a href="https://en.wikipedia.org/wiki/Timsort" target="_blank" rel="noopener">Timsort</a>.<br>å‡½æ•°åœ¨pythoné‡Œæ˜¯ä¸€ç­‰å…¬æ°‘ï¼Œå¯ä»¥ç®€åŒ–ç­–ç•¥æ¨¡å¼çš„å®ç°ã€‚</p>
<pre><code>def f1(seq):
    pass

def f2(seq):
    pass

def f(seq):
    if len(seq) &gt;= threshold_value:    # å¤§äºæŸä¸ªé˜ˆå€¼
        f1(seq)    # åœ¨æ•°é‡è¾ƒå¤šæ—¶å€™å…·æœ‰è‰¯å¥½çš„æ•ˆç‡
    else:
        f2(seq)
</code></pre><hr>
<h2 id="16-The-Template-Pattern-æ¨¡æ¿æ¨¡å¼ï¼šæŠ½è±¡å‡ºç®—æ³•å…¬å…±éƒ¨åˆ†ä»è€Œå®ç°ä»£ç å¤ç”¨"><a href="#16-The-Template-Pattern-æ¨¡æ¿æ¨¡å¼ï¼šæŠ½è±¡å‡ºç®—æ³•å…¬å…±éƒ¨åˆ†ä»è€Œå®ç°ä»£ç å¤ç”¨" class="headerlink" title="16: The Template Pattern(æ¨¡æ¿æ¨¡å¼ï¼šæŠ½è±¡å‡ºç®—æ³•å…¬å…±éƒ¨åˆ†ä»è€Œå®ç°ä»£ç å¤ç”¨)"></a>16: The Template Pattern(æ¨¡æ¿æ¨¡å¼ï¼šæŠ½è±¡å‡ºç®—æ³•å…¬å…±éƒ¨åˆ†ä»è€Œå®ç°ä»£ç å¤ç”¨)</h2><blockquote>
<p>Donâ€™t repeat yourself.<br>æ¨¡æ¿æ¨¡å¼ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠä»£ç ä¸­é‡å¤çš„éƒ¨åˆ†æŠ½å‡ºæ¥ä½œä¸ºä¸€ä¸ªæ–°çš„å‡½æ•°ï¼ŒæŠŠå¯å˜çš„éƒ¨åˆ†ä½œä¸ºå‡½æ•°å‚æ•°ï¼Œä»è€Œæ¶ˆé™¤ä»£ç å†—ä½™ã€‚å®é™…ä¸Šè¿™ç§æ¨¡å¼åœ¨ä»£ç é‡æ„çš„æ—¶å€™æ˜¯ç»å¸¸ä½¿ç”¨çš„ ï¼Œä½¿ç”¨ä¸€ä¸ªæœ‰æ„æ€çš„ä¾‹å­æ¥è¯´æ˜ä¸‹ï¼Œè¯·å®‰è£…<code>pip install cowpy</code>ï¼ŒçœŸæœ‰äººé—²çš„*ç–¼å†™è¿™ä¸ªç©æ„</p>
</blockquote>
<pre><code>from cowpy import cow


def dots_style(msg):
    msg = msg.capitalize()
    msg = &apos;.&apos; * 10 + msg + &apos;.&apos; * 10
    return msg


def admire_style(msg):
    msg = msg.upper()
    return &apos;!&apos;.join(msg)


def cow_style(msg):
    msg = cow.milk_random_cow(msg)
    return msg


def generate_banner(msg, style=dots_style):
    print(&apos;-- start of banner --&apos;)
    print(style(msg))
    print(&apos;-- end of banner --\n\n&apos;)


def main():
    msg = &apos;happy coding&apos;
    [generate_banner(msg, style) for style in (dots_style, admire_style,
                                            cow_style)]

if __name__ == &quot;__main__&quot;:
    main()


&quot;&quot;&quot;
-- start of banner --
..........Happy coding..........
-- end of banner --


-- start of banner --
H!A!P!P!Y! !C!O!D!I!N!G
-- end of banner --


-- start of banner --
______________
&lt; happy coding &gt;
--------------
    o
    o
    ^__^         /
    (**)\_______/  _________
    (__)\       )=(  ____|_ \_____
U    ||----w |  \ \     \_____ |
        ||     ||   ||           ||
-- end of banner --
&quot;&quot;&quot;
</code></pre><hr>
<h2 id="å•ä¾‹æ¨¡å¼-ä½¿å¾—ä¸€ä¸ªç±»æœ€å¤šç”Ÿæˆä¸€ä¸ªå®ä¾‹ã€‚"><a href="#å•ä¾‹æ¨¡å¼-ä½¿å¾—ä¸€ä¸ªç±»æœ€å¤šç”Ÿæˆä¸€ä¸ªå®ä¾‹ã€‚" class="headerlink" title="å•ä¾‹æ¨¡å¼: ä½¿å¾—ä¸€ä¸ªç±»æœ€å¤šç”Ÿæˆä¸€ä¸ªå®ä¾‹ã€‚"></a>å•ä¾‹æ¨¡å¼: ä½¿å¾—ä¸€ä¸ªç±»æœ€å¤šç”Ÿæˆä¸€ä¸ªå®ä¾‹ã€‚</h2><blockquote>
<p>Design ptterns are discoverd, not invented. - Alex Martelli</p>
</blockquote>
<p>å¾ˆå¥‡æ€ªï¼Œæœ¬ä¹¦è®²å®Œäº†éƒ½æ²¡æœ‰è®²åˆ°å•ä¾‹æ¨¡å¼ã€‚pythonçš„å•ä¾‹æ¨¡å¼æœ‰å„ç§å®ç°ï¼Œå…ƒç±»ã€è£…é¥°å™¨ç­‰ï¼Œä½†æ˜¯è¿˜æœ‰ä¸€ç§è¯´æ³•ï¼š</p>
<blockquote>
<p>I donâ€™t really see the need, as a module with functions (and not a class) would serve well as a singleton. All its variables would be bound to the module, which could not be instantiated repeatedly anyway.  If you do wish to use a class, there is no way of creating private classes or private constructors in Python, so you canâ€™t protect against multiple instantiations, other than just via convention in use of your API. I would still just put methods in a module, and consider the module as the singleton.</p>
</blockquote>
<p>ä¹Ÿå°±æ˜¯è¯´ï¼Œå®é™…ä¸Šï¼Œpythonä¸­ï¼Œå¦‚æœæˆ‘ä»¬åªç”¨ä¸€ä¸ªå®ä¾‹ï¼Œç›´æ¥è¿™ä¹ˆå†™å°±è¡Œ</p>
<pre><code># some module.py
class SingletonClass:
    pass

# åœ¨åˆ«å¤„æˆ‘ä»¬æƒ³ç”¨è¿™ä¸ªå®ä¾‹éƒ½ç›´æ¥ä½¿ç”¨ module.single_instance è¿™ä¸ªå®ä¾‹å°±å¥½ã€‚
# è¿™æ˜¯æœ€ç®€å•ä¹Ÿæ˜¯æœ€ç›´è§‚çš„ä¸€ç§æ–¹å¼,å—¯ï¼Œç›´æ¥å¯¼å…¥è¿™ä¸ªå®ä¾‹ç”¨ï¼Œè€Œä¸æ˜¯å¯¼å…¥classï¼Œç®€å•ç²—æš´
single_instance = SingletonClass()
</code></pre><p><a href="http://stackoverflow.com/questions/31875/is-there-a-simple-elegant-way-to-define-singletons-in-python" target="_blank" rel="noopener">Is there a simple, elegant way to define singletons in Python? [closed]</a></p>
<p>å…¶ä»–å®ç°ï¼š</p>
<pre><code># http://stackoverflow.com/questions/6760685/creating-a-singleton-in-python
class BaseClass:
    pass


# è£…é¥°å™¨å®ç°
def singleton(class_):
    instances = {}
    def getinstance(*args, **kwargs):
        if class_ not in instances:
            instances[class_] = class_(*args, **kwargs)
        return instances[class_]
    return getinstance


@singleton
class MyClass(BaseClass):
    pass


class Singleton(object):
    _instance = None
    def __new__(class_, *args, **kwargs):
        if not isinstance(class_._instance, class_):
            class_._instance = object.__new__(class_, *args, **kwargs)
        return class_._instance


class MyClass(Singleton, BaseClass):
pass


# å…ƒç±»å®ç°
class Singleton(type):
    _instances = {}
    def __call__(cls, *args, **kwargs):
        if cls not in cls._instances:
            cls._instances[cls] = super(Singleton, cls).__call__(*args, **kwargs)
        return cls._instances[cls]


# Python2
class MyClass(BaseClass):
    __metaclass__ = Singleton

# Python3
class MyClass(BaseClass, metaclass=Singleton):
    pass
</code></pre><hr>
<h2 id="é¢å‘è¿‡ç¨‹ä¸é¢å‘å¯¹è±¡"><a href="#é¢å‘è¿‡ç¨‹ä¸é¢å‘å¯¹è±¡" class="headerlink" title="é¢å‘è¿‡ç¨‹ä¸é¢å‘å¯¹è±¡"></a>é¢å‘è¿‡ç¨‹ä¸é¢å‘å¯¹è±¡</h2><p>è®¾è®¡æ¨¡å¼è®²å®Œäº†ï¼Œæ¥çœ‹çœ‹pythonä¸­OOPçš„ç›¸å…³ä¸œè¥¿ã€‚ç¬”è€…åœ¨ç»å†è¿‡çš„ä¸¤å®¶å…¬å¸è§åˆ°è¿‡å„ç§pythonç¨‹åºå‘˜ï¼Œä¹‹å‰çš„å…¬å¸æœ‰pythoné«˜æ‰‹ä¹ æƒ¯å†™OOPé£æ ¼çš„(ç»™æˆ‘å¾ˆæ·±å½±å“)ï¼Œç›®å‰æ‰€åœ¨å…¬å¸å¤§éƒ¨åˆ†äººå¯¹pythonçš„é¢å‘å¯¹è±¡ä¸æ˜¯å¾ˆç†Ÿï¼Œå†™å‡ºæ¥çš„åŸºæœ¬éƒ½æ˜¯è¿‡ç¨‹å¼çš„ã€‚</p>
<ul>
<li>è¿‡ç¨‹å¼: åŸºæœ¬éƒ½æ˜¯ä¸€ä¸ªä¸ªå‡½æ•°(function)æ¥å®ç°åŠŸèƒ½ï¼Œä½ ç»™æˆ‘ä¸€äº›å‚æ•°ï¼Œæˆ‘å¯¹å‚æ•°åšå‡ºå„ç§æ“ä½œï¼Œè¿”å›éœ€è¦çš„ç»“æœã€‚</li>
<li>é¢å‘å¯¹è±¡ï¼šæŠŠèµ„æºæŠ½è±¡æˆä¸€ä¸ªç±»ï¼Œæ•°æ®(data)å’Œæ–¹æ³•(method)çš„é›†åˆã€‚åœ¨æ„é€ å‡½æ•°ä¸­è¿›è¡Œæ•°æ®å±æ€§çš„åˆå§‹åŒ–ï¼Œåœ¨æ–¹æ³•ä¸­è¿›è¡Œå¯¹è±¡æ•°æ®çš„å„ç§æ“ä½œã€‚</li>
</ul>
<p>å“ªç§æ–¹å¼æ›´å¥½è¿™ä¸ªæˆ‘æš‚æ—¶æ²¡æœ‰å®šè®ºï¼Œç¼–ç¨‹è§„èŒƒä¹Ÿä¸ä¼šè¯´å¼ºåˆ¶ä½ ä½¿ç”¨å“ªç§é£æ ¼ã€‚ç¼–ç ä¸­å¾€å¾€æ²¡æœ‰ç»å¯¹æ­£ç¡®çš„ï¼Œåªæœ‰ç›¸å¯¹æ›´ä¼˜çš„ï¼Œå¦‚æœä¸å¥½å®šè®ºï¼Œé‚£å°±ä¸€è‡´ï¼Œæ˜“è¯»ï¼Œæ˜“ç”¨ï¼Œæ˜“ç»´æŠ¤çš„é£æ ¼ä¼˜å…ˆã€‚ä¸€èˆ¬æ¥è¯´ï¼Œèƒ½ç”¨å‡½æ•°å®ç°çš„ä¼˜å…ˆä½¿ç”¨å‡½æ•°ï¼Œç›¸æ¯”ç±»æ›´ç®€å•æ˜“ç»´æŠ¤ã€‚å¦‚æœå¤šä¸ªè¿‡ç¨‹å…±äº«ä¸€äº›çŠ¶æ€ï¼ˆæ“ä½œ+æ•°æ®ï¼‰ï¼Œè¿™æ—¶å€™ä½¿ç”¨ç±»å°±æ¯”è¾ƒé€‚åˆã€‚ä½¿ç”¨ç±»çš„æ—¶å€™å°½é‡ä¿æŒç»§æ‰¿å±‚çº§ç®€å•ï¼Œå¦‚æœåŒæ ·å¯ä»¥å®ŒæˆåŠŸèƒ½ï¼Œä¼˜å…ˆä½¿ç”¨ç»„åˆè€Œéç»§æ‰¿ã€‚</p>
<hr>
<h2 id="pythonä¸­çš„æŠ½è±¡åŸºç±»"><a href="#pythonä¸­çš„æŠ½è±¡åŸºç±»" class="headerlink" title="pythonä¸­çš„æŠ½è±¡åŸºç±»"></a>pythonä¸­çš„æŠ½è±¡åŸºç±»</h2><p>åœ¨pythonä¸­æˆ‘ä»¬å¯ä»¥ä½¿ç”¨å†…ç½®çš„abc(abstract base class)æ¨¡å—æ¥å®ç°æŠ½è±¡åŸºç±»ã€‚ä»€ä¹ˆæ—¶å€™éœ€è¦ä¸€ä¸ªæŠ½è±¡åŸºç±»å‘¢ï¼Ÿ</p>
<ul>
<li>æŠ½è±¡åŸºç±»æ˜¯æ²¡æ³•è¢«å®ä¾‹åŒ–çš„ã€‚</li>
<li>æŠ½è±¡åŸºç±»ä¸­å®šä¹‰æŠ½è±¡æ–¹æ³•å¼ºåˆ¶å­ç±»å»å®ç°ã€‚</li>
</ul>
<pre><code># ä¸ºäº†å®ç°è¿™ä¸¤ä¸ªç‰¹æ€§ï¼Œæˆ‘ä»¬å¯ä»¥è¿™ä¹ˆå†™
class Base:
    def foo(self):
        raise NotImplementedError()

    def bar(self):
        raise NotImplementedError()

class Concrete(Base):
    def foo(self):
        return &apos;foo() called&apos;

    # Oh no, we forgot to override bar()...
    # def bar(self):
    #     return &quot;bar() called&quot;
</code></pre><p>ä½†æ˜¯è¿™ä¹ˆå†™ä¾ç„¶å¯ä»¥å®ä¾‹åŒ–Baseï¼Œpython2.6ä»¥åå¼•å…¥äº†abcæ¨¡å—å¸®åŠ©æˆ‘ä»¬å®ç°è¿™ä¸ªåŠŸèƒ½ã€‚</p>
<pre><code>from abc import ABCMeta, abstractmethod

class Base(metaclass=ABCMeta):
    @abstractmethod
    def foo(self):
        pass

    @abstractmethod
    def bar(self):
        pass

class Concrete(Base):
    def foo(self):
        pass
    # We forget to declare bar() again...
</code></pre><p>ä½¿ç”¨è¿™ç§æ–¹å¼å¦‚æœæ²¡æœ‰åœ¨å­ç±»é‡Œå®ç°baræ–¹æ³•ä½ æ˜¯æ²¡æœ‰åŠæ³•å®ä¾‹åŒ–å­ç±»çš„ã€‚</p>
<p><a href="https://dbader.org/blog/abstract-base-classes-in-python" target="_blank" rel="noopener">ã€ŠAbstract Base Classes in Pythonã€‹</a></p>
<p><a href="http://stackoverflow.com/questions/3570796/why-use-abstract-base-classes-in-python" target="_blank" rel="noopener">ã€Šhttp://stackoverflow.com/questions/3570796/why-use-abstract-base-classes-in-pythonã€‹</a></p>
<p><a href="https://docs.python.org/2/library/abc.html" target="_blank" rel="noopener">ã€Šhttps://docs.python.org/2/library/abc.htmlã€‹</a></p>
<hr>
<h2 id="pythonä¸­çš„Mixin"><a href="#pythonä¸­çš„Mixin" class="headerlink" title="pythonä¸­çš„Mixin"></a>pythonä¸­çš„Mixin</h2><p>Mixinæ˜¯ä¸ºäº†ç»™ä¸€ä¸ªç±»æ‰©å……åŠŸèƒ½ç”¨çš„ï¼Œå®ƒä¹Ÿæ²¡æ³•è¢«å®ä¾‹åŒ–ã€‚æˆ‘ä»¬å¯ä»¥åœ¨Mixinç±»é‡Œå®ç°ä¸€äº›æ–¹æ³•ç»™ç±»æ‰©å……åŠŸèƒ½ã€‚ä½ å¯èƒ½ä¼šé—®äº†ï¼Œé‚£ä¸ºå•¥ä¸ç›´æ¥å†™åœ¨ç±»é‡Œå¤´ï¼Œæ¯”å¦‚ç”¨@staticmethodæ–¹æ³•ï¼Ÿæˆ‘çš„ç†è§£æ˜¯è¿™æ ·çš„ï¼Œä¸ºäº†ã€é«˜å†…èšã€ã€‚å¦‚æœä½ ç”¨è¿‡pylintæ£€æµ‹ä»£ç ï¼Œä½ ä¼šå‘ç°ä½ åœ¨å†™ç±»çš„ä¸€ä¸ªæ–¹æ³•æ—¶ï¼Œå¦‚æœåœ¨å†™ä¸€ä¸ªmethodæ—¶æ²¡æœ‰ä½¿ç”¨åˆ°ä»»ä½•selfé‡Œçš„ä¸œè¥¿ï¼Œpylintä¼šç»™æç¤ºã€R0201 Method could be a function [pylint]ã€ï¼Œæ„æ€æ˜¯è¿™ä¸ªæ–¹æ³•å¯ä»¥å¯ä»¥å•ç‹¬å†™æˆä¸€ä¸ªå‡½æ•°ï¼Œä¸å¿…è¦å†™åœ¨ç±»é‡Œã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œåªæœ‰ä¸€ä¸ªç±»é‡Œå®ç°çš„æ–¹æ³•éƒ½æ˜¯ä½¿ç”¨äº†selfé‡Œçš„æ•°æ®æ—¶æ‰èƒ½æˆä¸ºé«˜å†…èšçš„ï¼ˆæˆ‘ä¸çŸ¥é“æˆ‘è¿™æ ·ç†è§£å¯¹ä¸å¯¹ï¼‰ã€‚ä¾‹å­ï¼šflask_loginæ’ä»¶æœ‰ä¸ªUserMixinç»™å®šä¹‰çš„ç”¨æˆ·ç±»å®ç°ç™»å½•åŠŸèƒ½ã€‚</p>

      
    </div>
    <footer>
      
          
          <div class="clearfix"></div>
          <nav id="pagination">
  
    <a href="/2017/01/06/python/getting-started-with-pyparsing/" class="alignleft prev"><i class="fa fa-long-arrow-left"></i>Next</a>
  
  
    <a href="/2016/12/30/python/write-maintainable-python-project/" class="alignright next">Prev<i class="fa fa-long-arrow-right"></i></a>
  
  <div class="clearfix"></div>
</nav>
      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>


<section id="comment">
  <h1 class="title">ç•™è¨€</h1>

  
</section>



    <div class="clearfix"></div>
  </div>
  <footer id="footer" class="inner"><div>
  
  &copy; 2018 PegasusWang
  
</div>
Powered by <a href="http://zespia.tw/hexo/" title="Hexo" target="_blank" rel="noopener">Hexo</a> and <a href="http://pages.github.com/" title="GitHub Pages" target="_blank" rel="noopener">GitHub Pages</a>

<div class="clearfix"></div>


<!--
<span id="busuanzi_container_site_pv">
    æ‚¨æ˜¯ç¬¬<span id="busuanzi_value_site_pv"></span>æ¬¡è®¿é—®æ»´ç«¥é‹
</span>

<script async
src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js">
</script>
-->
</footer>
  
<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>
<script src="//netdna.bootstrapcdn.com/bootstrap/3.1.0/js/bootstrap.min.js"></script>




    <script type="text/javascript">
        (function(){

            $(window).scroll(function(){

                var scrollTop = $(window).scrollTop();
                if ( scrollTop >200 ){
                    $("#main-nav").removeClass('normal_mode').addClass('top_mode');
                } else{
                    $("#main-nav").removeClass('top_mode').addClass('normal_mode');
                }

            });

        })();
    </script>



  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>
  <script type="text/javascript">
  (function($){
    $('.fancybox').fancybox({
      'titlePosition': 'inside'
    });
  })(jQuery);
  </script>




<script type="text/javascript">
  
  $(function(){

    $('.title').hover(
      function() {      
        $(this).stop().animate(
          {'marginLeft': '10px'}, 200
        );   
      }, 
      function() {       
        $(this).stop().animate({'marginLeft': '0px'}, 200);      
      
    });   

  });

</script>


</body>
</html>